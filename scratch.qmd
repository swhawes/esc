!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

```{r}

# Step 2: Convert the contingency table to a data frame
contingency_df_serviceType <- as.data.frame.matrix(contingency_table_serviceType)

# Step 3: Add a new column with the total count of individuals in each cohort
contingency_df_serviceType$Total <- rowSums(contingency_df_serviceType)

# Step 4: Rename the 'Total' column to 'Count'
contingency_df_serviceType <- contingency_df_serviceType %>%
  rownames_to_column(var = "Cohort") %>%
  rename(Count = Total)

# Step 5: Calculate proportions for each risk category and format them as percentages
contingency_df_serviceType <- contingency_df_serviceType %>%
  mutate(across(contains(" "), ~ sprintf("%d (%d%%)", ., round(./Count * 100))))




# Step 8: Reorder columns so 'Count' is the second column
contingency_df_serviceType <- contingency_df_serviceType %>%
  select(Cohort, Count, everything())

# Step 9: Sort the data frame in descending order based on 'Count'
contingency_df_serviceType <- contingency_df_serviceType %>%
  arrange(desc(Count))

# Step x: Add an index column
contingency_df_serviceType <- contingency_df_serviceType %>%
  mutate(Index = row_number())

# Step x: Reorder the columns to have the index as the first column
contingency_df_serviceType <- contingency_df_serviceType %>%
  select(Index, everything())

```